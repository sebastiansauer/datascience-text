{
  "hash": "0cb300cc504f9c521b73d1b0f3b749df",
  "result": {
    "markdown": "---\noutput: html_document\neditor_options: \n  chunk_output_type: console\n---\n\n\n# Klassifikation von Hatespeech\n\n\n\n\n\n## Vorab\n\n\n### Lernziele\n\n\n- Sie k√∂nnen grundlegende Verfahren zur Klassifikation von Hatespeech einsetzen und erkl√§ren\n\n\n\n\n\n\n\n\n### Ben√∂tigte R-Pakete\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-1_dbe4cb66bdc8dbeeb08b21e63083b2f2'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(easystats)\nlibrary(tidymodels)\nlibrary(tidytext)\nlibrary(textrecipes)\nlibrary(lsa)  # stopwords\nlibrary(discrim)  # naive bayes classification\nlibrary(naivebayes)\nlibrary(tictoc)  # Zeitmessung\nlibrary(fastrtext)  # Worteinbettungen\nlibrary(remoji)  # Emojis\nlibrary(tokenizers)  # Vektoren tokenisieren\n```\n:::\n\n\n\n## Daten\n\n\nF√ºr Maschinenlernen brauchen wir Trainingsdaten,\nDaten also, bei denen wir pro Beobachtung der Wert der Zielvariablen kennen.\nMan spricht auch von \"gelabelten\" Daten.\n\nWir nutzen die Daten von @wiegand_germeval bzw. @wiegand-data.\nDie Daten sind unter CC-By-4.0 Int. lizensiert.\n\n\n::: {.cell hash='klassifikation_cache/html/import-heidelberg-data_2e50e9c561d941f1d72dd9058c77cd8d'}\n\n```{.r .cell-code}\nd_raw <- \n  data_read(\"data/germeval2018.training.txt\",\n         header = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in data.table::fread(input = path, ...): Found and resolved improper\nquoting out-of-sample. First healed line 111: <<\"Edel sei der Mensch, hilfreich\nund gut\" - Nicht eine dieser Charaktereigenschaften kann Merkel f√ºr sich\nbeanspruchen. OTHER OTHER>>. If the fields are not quoted (e.g. field separator\ndoes not appear within any field), try quote=\"\" to avoid this warning.\n```\n:::\n:::\n\n\n\nDie Daten finden sich auch im Paket [pradadata](https://github.com/sebastiansauer/pradadata).\n\nDa die Daten keine Spaltenk√∂pfe haben, informieren wir die Funktion dazu mit `header = FALSE`.\n\nBenennen wir die die Spalten um:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-2_ffce71786af673ec0286d362e54fac1e'}\n\n```{.r .cell-code}\nnames(d_raw) <- c(\"text\", \"c1\", \"c2\")\n```\n:::\n\n\nDabei soll `c1` und `c2` f√ºr die 1. bzw. 2. Klassifikation stehen.\n\n\nIn `c1` finden sich diese Werte:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-3_ec8a5462101a2e904367eab06bb7623b'}\n\n```{.r .cell-code}\nd_raw %>% \n  count(c1)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|c1      |    n|\n|:-------|----:|\n|OFFENSE | 1688|\n|OTHER   | 3321|\n\n</div>\n:::\n:::\n\n\nHier wurde klassifiziert,\nob beleidigende Sprache (offensive language) vorlag oder nicht [@isch-etal-2021-overview, S. 2]:\n\n\n>   Task 1 was to decide whether a tweet includes some form of offensive language or not. The tweets had to be classiÔ¨Åed into the two classes OFFENSE and OTHER. The OFFENSE category covered abusive language, insults, as well as merely profane statements.\n\n\nUnd in `c2` finden sich folgende Auspr√§gungen:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-4_d84ef45b2c95f0fb28f404187739ae23'}\n\n```{.r .cell-code}\nd_raw %>% \n  count(c2)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|c2        |    n|\n|:---------|----:|\n|ABUSE     | 1022|\n|INSULT    |  595|\n|OTHER     | 3321|\n|PROFANITY |   71|\n\n</div>\n:::\n:::\n\n\n\nIn `c2` ging es um eine feinere Klassifikation beleidigender Sprache [@isch-etal-2021-overview, S. 2]:\n\n>   The second task involved four categories, a nonoffensive OTHER class and three sub-categories of what is OFFENSE in Task 1. In the case of PROFANITY, profane words are used, however, the tweet does not want to insult anyone. This typically concerns the usage of swearwords (Schei√üe, Fuck etc.) and cursing (Zur H√∂lle! Verdammt! etc.). This can be often found in youth language. Swearwords and cursing may, but need not, co-occur with insults or abusive speech. Profane language may in fact be used in tweets with positive sentiment to express emphasis. Whenever profane words are not directed towards a speciÔ¨Åc person or group of persons and there are no separate cues of INSULT or ABUSE, then tweets are labeled as simple cases of PROFANITY.\n\n\n\n\nSind Texte, die als `OFFENSE` klassifiziert sind,\nauch (fast) immer als `ABUSE`, `INSULT` oder `PROFANITY` klassifiziert?\n\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-5_ef75f7566b7d35a79c95ff27f839d505'}\n\n```{.r .cell-code}\nd_raw %>% \n  filter(c1 == \"OTHER\", c2 == \"OTHER\") %>% \n  nrow() / nrow(d_raw)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6630066\n```\n:::\n:::\n\n\nIn ca. 2/3 der F√§lle wurden in beiden Klassifikation `OTHER` klassifiziert.\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-6_729200e672190fbda2cf3addbe896963'}\n\n```{.r .cell-code}\nd_raw %>% \n  filter(c1 != \"OTHER\", c2 != \"OTHER\") %>% \n  nrow() / nrow(d_raw)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3369934\n```\n:::\n:::\n\n\nEntsprechend in ca. 1/3 der F√§lle wurde jeweils nicht mit `OTHER` klassifiziert.\n\n\nWir begn√ºgen uns hier mit der ersten, gr√∂beren Klassifikation.\n\n\n\nF√ºgen wir abschlie√üend noch eine ID-Variable hinzu:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-7_4b3d59e8350ce08dc460abba7338d3c2'}\n\n```{.r .cell-code}\nd1 <-\n  d_raw %>% \n  mutate(id = as.character(1:nrow(.)))\n```\n:::\n\n\n\nDie ID-Variable definieren als Text (nicht als Integer),\nda die Twitter-IDs zwar nat√ºrliche Zahlen sind,\naber zu gro√ü, um von R als Integer verarbeitet zu werden.\nFaktisch sind sie f√ºr uns auch nur nominal skalierte Variablen,\nso dass wir keinen Informationsverlust haben.\n\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-8_9bc0dcafd086d3405d8b82bbeea81e82'}\n\n```{.r .cell-code}\n#write_rds(d1, \"objects/d1.rds\")\n```\n:::\n\n\n\n\n## Feature Engineering\n\n\nReichern wir die Daten mit weiteren Features an,\nin der Hoffnung, damit eine bessere Klassifikation erzielen zu k√∂nnen.\n\n\n### Textl√§nge\n\n\n\n\n\n::: {.cell hash='klassifikation_cache/html/d2_1451d9310c78ef6b1eb16af745ce9f35'}\n\n```{.r .cell-code}\nd2 <-\n  d1 %>% \n  mutate(text_length = str_length(text))\n\nhead(d2)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|text                                                                                                                                                                                                                                                                                         |c1      |c2     |id | text_length|\n|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------|:------|:--|-----------:|\n|@corinnamilborn Liebe Corinna, wir w√ºrden dich gerne als Moderatorin f√ºr uns gewinnen! W√§rst du begeisterbar?                                                                                                                                                                                |OTHER   |OTHER  |1  |         109|\n|@Martin28a Sie haben ja auch Recht. Unser Tweet war etwas missverst√§ndlich. Dass das BVerfG Sachleistungen nicht ausschlie√üt, kritisieren wir.                                                                                                                                               |OTHER   |OTHER  |2  |         142|\n|@ahrens_theo fr√∂hlicher gru√ü aus der sch√∂nsten stadt der welt theo ‚öìÔ∏è                                                                                                                                                                                                                        |OTHER   |OTHER  |3  |          69|\n|@dushanwegner Amis h√§tten alles und jeden gew√§hlt...nur Hillary wollten sie nicht und eine Fortsetzung von Obama-Politik erst recht nicht..!                                                                                                                                                 |OTHER   |OTHER  |4  |         140|\n|@spdde kein verl√§√ülicher Verhandlungspartner. Nachkarteln nach den Sondierzngsgespr√§chen - schickt diese St√ºmper #SPD in die Versenkung.                                                                                                                                                     |OFFENSE |INSULT |5  |         136|\n|@Dirki_M Ja, aber wo widersprechen die Zahlen denn denen, die im von uns verlinkten Artikel stehen? In unserem Tweet geht es rein um subs. Gesch√ºtzte. 2017 ist der gesamte Familiennachzug im Vergleich zu 2016 - die Zahlen, die Hr. Brandner bem√ºht - √ºbrigens leicht r√ºckl√§ufig gewesen. |OTHER   |OTHER  |6  |         284|\n\n</div>\n:::\n:::\n\n\n\n\n### Sentimentanalyse\n\nWir nutzen dazu `SentiWS` [@Remus2010].\n\n\n::: {.cell hash='klassifikation_cache/html/read-sentiws_2f767942281bb38d29abade5a1aa0999'}\n\n```{.r .cell-code}\nsentiws <- read_csv(\"https://osf.io/x89wq/?action=download\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 3468 Columns: 4\n‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nDelimiter: \",\"\nchr (3): neg_pos, word, inflections\ndbl (1): value\n\n‚Ñπ Use `spec()` to retrieve the full column specification for this data.\n‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n:::\n\n::: {.cell hash='klassifikation_cache/html/d2-long_77a2f69e65e911b3658137b948ada80a'}\n\n```{.r .cell-code}\nd2_long <-\n  d2 %>% \n  unnest_tokens(input = text, output = token)\n\nhead(d2_long)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|c1    |c2    |id | text_length|token          |\n|:-----|:-----|:--|-----------:|:--------------|\n|OTHER |OTHER |1  |         109|corinnamilborn |\n|OTHER |OTHER |1  |         109|liebe          |\n|OTHER |OTHER |1  |         109|corinna        |\n|OTHER |OTHER |1  |         109|wir            |\n|OTHER |OTHER |1  |         109|w√ºrden         |\n|OTHER |OTHER |1  |         109|dich           |\n\n</div>\n:::\n:::\n\n\nJetzt filtern wir unsere Textdaten so,\ndass nur W√∂rter mit Sentimentwert √ºbrig bleiben:\n\n\n::: {.cell hash='klassifikation_cache/html/d2-senti-long_2b9caa6e08a624466310b69af250e5b9'}\n\n```{.r .cell-code}\nd2_long_senti <- \n  d2_long %>%  \n  inner_join(sentiws %>% select(-inflections), by = c(\"token\" = \"word\"))\n\nhead(d2_long)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|c1    |c2    |id | text_length|token          |\n|:-----|:-----|:--|-----------:|:--------------|\n|OTHER |OTHER |1  |         109|corinnamilborn |\n|OTHER |OTHER |1  |         109|liebe          |\n|OTHER |OTHER |1  |         109|corinna        |\n|OTHER |OTHER |1  |         109|wir            |\n|OTHER |OTHER |1  |         109|w√ºrden         |\n|OTHER |OTHER |1  |         109|dich           |\n\n</div>\n:::\n:::\n\n\n\nSchlie√ülich berechnen wir die Sentimentwert pro Polarit√§t und pro Tweet:\n\n\n::: {.cell hash='klassifikation_cache/html/d2-sentis_5c4829559233ee9cbd1e3ec1127865e4'}\n\n```{.r .cell-code}\nd2_sentis <-\n  d2_long_senti %>% \n  group_by(id, neg_pos) %>% \n  summarise(senti_avg = mean(value))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'id'. You can override using the `.groups`\nargument.\n```\n:::\n\n```{.r .cell-code}\nhead(d2_sentis)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|id   |neg_pos | senti_avg|\n|:----|:-------|---------:|\n|1    |pos     |    0.0040|\n|1012 |neg     |   -0.2087|\n|1013 |neg     |   -0.0420|\n|1015 |neg     |   -0.0048|\n|1021 |pos     |    0.0845|\n|1024 |neg     |   -0.4787|\n\n</div>\n:::\n:::\n\n\n\nDiese Tabelle bringen wir wieder eine breitere Form,\num sie dann wieder mit den Hauptdaten zu vereinigen.\n\n\n\n::: {.cell hash='klassifikation_cache/html/d2-sentis-wide_9de5e00b949578004a81dcb9a79e8311'}\n\n```{.r .cell-code}\nd2_sentis_wide <-\n  d2_sentis %>% \n  pivot_wider(names_from = \"neg_pos\", values_from = \"senti_avg\")\n\nd2_sentis_wide %>% head()\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|id   |    pos|     neg|\n|:----|------:|-------:|\n|1    | 0.0040|      NA|\n|1012 |     NA| -0.2087|\n|1013 |     NA| -0.0420|\n|1015 |     NA| -0.0048|\n|1021 | 0.0845|      NA|\n|1024 | 0.0040| -0.4787|\n\n</div>\n:::\n:::\n\n::: {.cell hash='klassifikation_cache/html/d3_d83097a4828f8e33a43bba65b437d2df'}\n\n```{.r .cell-code}\nd3 <-\n  d2 %>% \n  full_join(d2_sentis_wide)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining, by = \"id\"\n```\n:::\n\n```{.r .cell-code}\nhead(d3)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|text                                                                                                                                                                                                                                                                                         |c1      |c2     |id | text_length|   pos|     neg|\n|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------|:------|:--|-----------:|-----:|-------:|\n|@corinnamilborn Liebe Corinna, wir w√ºrden dich gerne als Moderatorin f√ºr uns gewinnen! W√§rst du begeisterbar?                                                                                                                                                                                |OTHER   |OTHER  |1  |         109| 0.004|      NA|\n|@Martin28a Sie haben ja auch Recht. Unser Tweet war etwas missverst√§ndlich. Dass das BVerfG Sachleistungen nicht ausschlie√üt, kritisieren wir.                                                                                                                                               |OTHER   |OTHER  |2  |         142|    NA| -0.3466|\n|@ahrens_theo fr√∂hlicher gru√ü aus der sch√∂nsten stadt der welt theo ‚öìÔ∏è                                                                                                                                                                                                                        |OTHER   |OTHER  |3  |          69|    NA|      NA|\n|@dushanwegner Amis h√§tten alles und jeden gew√§hlt...nur Hillary wollten sie nicht und eine Fortsetzung von Obama-Politik erst recht nicht..!                                                                                                                                                 |OTHER   |OTHER  |4  |         140|    NA|      NA|\n|@spdde kein verl√§√ülicher Verhandlungspartner. Nachkarteln nach den Sondierzngsgespr√§chen - schickt diese St√ºmper #SPD in die Versenkung.                                                                                                                                                     |OFFENSE |INSULT |5  |         136|    NA|      NA|\n|@Dirki_M Ja, aber wo widersprechen die Zahlen denn denen, die im von uns verlinkten Artikel stehen? In unserem Tweet geht es rein um subs. Gesch√ºtzte. 2017 ist der gesamte Familiennachzug im Vergleich zu 2016 - die Zahlen, die Hr. Brandner bem√ºht - √ºbrigens leicht r√ºckl√§ufig gewesen. |OTHER   |OTHER  |6  |         284| 0.004| -0.2042|\n\n</div>\n:::\n:::\n\n\n\n:::callout-note\nDie Sentimentanalyse hier vernachl√§ssigt Flexionen der W√∂rter. \nDer  Autor f√ºhlt den Drang zu schreiben: \"Left as an exercise for the reader\" :-)\n:::\n\n\n### Schimpfw√∂rter\n\n\nZ√§hlen wir die Schimpfw√∂rter pro Text.\nDazu nutzen wir die Daten von [LDNOOBW](https://github.com/LDNOOBW/List-of-Dirty-Naughty-Obscene-and-Otherwise-Bad-Words/blob/master/LICENSE), lizensiert nach CC-BY-4.0-Int.\n\n\n\n\n\n::: {.cell hash='klassifikation_cache/html/schimpf1_3884659976869abefd104c9056540c8a'}\n\n```{.r .cell-code}\nschimpf1 <- data_read(\"https://raw.githubusercontent.com/LDNOOBW/List-of-Dirty-Naughty-Obscene-and-Otherwise-Bad-Words/master/de\", format = \",\", header = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nReading data...\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nPreparing data... Almost there!\n```\n:::\n:::\n\n\n\nL√§nger aber noch ist die Liste aus dem [InsultWiki](https://www.insult.wiki/schimpfwort-liste), lizensiert CC0.\n\n\n\n::: {.cell hash='klassifikation_cache/html/schimpf2_310d61711446c1b9e46794b6c44f40cd'}\n\n```{.r .cell-code}\nschimpf2 <- \n  data_read(\"data/insult-de.txt\", header = FALSE) %>% \n  mutate_all(str_to_lower)\n```\n:::\n\n\n\n\nDie Daten finden sich auch im Paket [pradadata](https://github.com/sebastiansauer/pradadata).\n\nBinden wir die Listen zusammen:\n\n\n::: {.cell hash='klassifikation_cache/html/schimpf_ecce05ce4ac3c086638e936ea1a06201'}\n\n```{.r .cell-code}\nschimpf <-\n  schimpf1 %>% \n  bind_rows(schimpf2) %>% \n  distinct() %>% \n  rename(word = \"V1\")\n\nnrow(schimpf)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6208\n```\n:::\n:::\n\n\n\nUm die Lesis vor (unn√∂tiger?) Kopfverschmutzung zu bewahren,\nsind diese Schimpfw√∂rter hier nicht abgedruckt.\n\nJetzt z√§hlen wir, ob unsere Tweets/Texte solcherlei W√∂rter enthalten.\n\n\n\n::: {.cell hash='klassifikation_cache/html/d_schimpf_57a07b8f735ebff8cd47cc45337655a0'}\n\n```{.r .cell-code}\nd_schimpf <- \nd2_long %>% \n  select(id, token) %>% \n  mutate(schimpf = token %in% schimpf$word)\n```\n:::\n\n\n\nWie viele Schimpfw√∂rter haben wir gefunden?\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-9_02e109b8239fdc34169246df4f0570a6'}\n\n```{.r .cell-code}\nd_schimpf %>% \n  count(schimpf)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|schimpf |     n|\n|:-------|-----:|\n|FALSE   | 99081|\n|TRUE    |  1136|\n\n</div>\n:::\n:::\n\n\n\nEtwa ein Prozent der W√∂rter sind Schimpfw√∂rter in unserem Corpus.\n\n\n\n::: {.cell hash='klassifikation_cache/html/d-schimpf2_984b0cf907f12cf5b82a79ea4a40201d'}\n\n```{.r .cell-code}\nd_schimpf2 <-\n  d_schimpf %>% \n  group_by(id) %>% \n  summarise(schimpf_n = sum(schimpf))\n\nhead(d_schimpf2)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|id   | schimpf_n|\n|:----|---------:|\n|1    |         0|\n|10   |         0|\n|100  |         0|\n|1000 |         0|\n|1001 |         0|\n|1002 |         0|\n\n</div>\n:::\n:::\n\n::: {.cell hash='klassifikation_cache/html/d_main_e41e00cfd20f68b086b0ff8103652b8c'}\n\n```{.r .cell-code}\nd_main <-\n  d3 %>% \n  full_join(d_schimpf2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining, by = \"id\"\n```\n:::\n:::\n\n\n\n:::callout-important\nNamen wie `final`, `main` oder `result` sind gef√§hrlich,\nda es unter Garantie ein \"final-final geben wird, oder der \"Haupt-Datensat\" pl√∂tzlich nicht mehr so wichtig erscheint und so weiter.\n:::\n\n\n\n### Emojis\n\n\n\n::: {.cell hash='klassifikation_cache/html/get-emoji-list_ca798f5f68205b7edbb1f7a73d40dfff'}\n\n```{.r .cell-code}\nemj <- emoji(list_emoji(), pad = FALSE)\n\nhead(emj)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"üòÑ\" \"üòÉ\" \"üòÄ\" \"üòä\" \"‚ò∫Ô∏è\"  \"üòâ\"\n```\n:::\n:::\n\n\nDiese Liste umfasst knapp 900 Emojis, \ndas sind allerdings noch nicht alle, die es gibt.\n[Diese Liste](https://unicode.org/emoji/charts/full-emoji-list.html) umfasst mit gut 1800 Emojis\ngut das Doppelte.\n\n\nSelbstkuratierte Liste an \"wilden\" Emoji;\ndiese Liste ist inspiriert von [emojicombos.com](https://emojicombos.com/disgust).\n\n\n::: {.cell hash='klassifikation_cache/html/wild-emojis_b368addb07723643fa84560f46f21ee0'}\n\n```{.r .cell-code}\nwild_emojis <- \n  c(\n    emoji(find_emoji(\"gun\")),\n    emoji(find_emoji(\"bomb\")),\n    emoji(find_emoji(\"fist\")),\n    emoji(find_emoji(\"knife\"))[1],\n    emoji(find_emoji(\"ambulance\")),\n    emoji(find_emoji(\"fist\")),\n    emoji(find_emoji(\"skull\")),\n    \"‚ò†Ô∏è\",     \"üóë\",       \"üò†\",    \"üëπ\",    \"üí©\" ,\n    \"üñï\",    \"üëéÔ∏è\",\n    emoji(find_emoji(\"middle finger\")),    \"üò°\",    \"ü§¢\",    \"ü§Æ\",  \n    \"üòñ\",    \"üò£\",    \"üò©\",    \"üò®\",    \"üòù\",    \"üò≥\",    \"üò¨\",    \"üò±\",    \"üòµ\",\n       \"üò§\",    \"ü§¶‚Äç‚ôÄÔ∏è\",    \"ü§¶‚Äç\"\n  )\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-10_1d1c601a35dd76ad5dde1860d7da34fd'}\n\n```{.r .cell-code}\nwild_emojis_df <-\n  tibble(emoji = wild_emojis)\n\nsave(wild_emojis_df, file = \"data/wild_emojis.RData\")\n```\n:::\n\n\n\n\nAuf dieser Basis k√∂nnen wir einen Pr√§diktor erstellen,\nder z√§hlt, ob ein Tweet einen oder mehrere der \"wilden\" Emojis enth√§lt.\n\n\n## Workflow 1: Rezept 1 + Naive-Bayes\n\n\n### Dummy-Rezept\n\n\nHier ist ein einfaches Beispiel,\num die Textvorbereitung mit `{textrecipes}` zu verdeutlichen.\n\nWir erstellen uns einen Dummy-Text:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-11_a5239d98a6ae43a021cda5d0326057df'}\n\n```{.r .cell-code}\ndummy <- \n  tibble(text = c(\"Ich gehe heim und der die das nicht in ein and the\"))\n```\n:::\n\n\n\nDann tokenisieren wir den Text:\n\n\n::: {.cell hash='klassifikation_cache/html/rec-dummy1_9643d039e34554853ae829e08551ed05'}\n\n```{.r .cell-code}\nrec_dummy <-\n  recipe(text ~ 1, data = dummy) %>% \n  step_tokenize(text)\n  \nrec_dummy\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRecipe\n\nInputs:\n\n    role #variables\n outcome          1\n\nOperations:\n\nTokenization for text\n```\n:::\n:::\n\n\n\nDie Tokens kann man sich so zeigen lassen:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-12_29209dc974b17c9b23571650615d86f1'}\n\n```{.r .cell-code}\nshow_tokens(rec_dummy, text)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n [1] \"ich\"   \"gehe\"  \"heim\"  \"und\"   \"der\"   \"die\"   \"das\"   \"nicht\" \"in\"   \n[10] \"ein\"   \"and\"   \"the\"  \n```\n:::\n:::\n\n\n\nJetzt entfernen wir die Stopw√∂rter deutscher Sprache;\ndaf√ºr nutzen wir die Stopwort-Quelle `snowball`:\n\n\n\n::: {.cell hash='klassifikation_cache/html/rec-dummy2_17b8002eaabf808eb5898d5d9c9adc77'}\n\n```{.r .cell-code}\nrec_dummy <-\n  recipe(text ~ 1, data = dummy) %>% \n  step_tokenize(text) %>% \n  step_stopwords(text, language = \"de\", stopword_source = \"snowball\")\n\nrec_dummy\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRecipe\n\nInputs:\n\n    role #variables\n outcome          1\n\nOperations:\n\nTokenization for text\nStop word removal for text\n```\n:::\n:::\n\n\n\nPr√ºfen wir die Tokens; \nsind die Stopw√∂rter wirklich entfernt?\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-13_6d3e0fd3a502d214d47c7762e52d68ec'}\n\n```{.r .cell-code}\nshow_tokens(rec_dummy, text)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n[1] \"gehe\" \"heim\" \"and\"  \"the\" \n```\n:::\n:::\n\n\n\nJa, die deutschen Stopw√∂rter sind entfernt. Die englischen nicht;\ndas macht Sinn!\n\n\n### Datenaufteilung\n\n\n\n::: {.cell hash='klassifikation_cache/html/d-split2_5cd853b5f88eb053f31d264cfb811947'}\n\n```{.r .cell-code}\nd_split <- initial_split(d_main, strata = c1)\n\nd_train <- training(d_split)\nd_test <- testing(d_split)\n```\n:::\n\n\n\n\n\n\n### Rezept 1\n\n\nRezept definieren:\n\n\n::: {.cell hash='klassifikation_cache/html/rec1_862c91870170ce220bfcb73a09c9c2b7'}\n\n```{.r .cell-code}\nrec1 <- \n  recipe(c1 ~ ., data = select(d_train, text, c1, id)) %>% \n  update_role(id, new_role = \"id\") %>% \n  step_tokenize(text) %>% \n  step_stopwords(text, language = \"de\", stopword_source = \"snowball\") %>% \n  step_stem(text) %>% \n  step_tokenfilter(text, max_tokens = 1e2) %>% \n  step_tfidf(text) %>% \n  step_normalize(all_numeric_predictors())\n\nrec1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRecipe\n\nInputs:\n\n      role #variables\n        id          1\n   outcome          1\n predictor          1\n\nOperations:\n\nTokenization for text\nStop word removal for text\nStemming for text\nText filtering for text\nTerm frequency-inverse document frequency with text\nCentering and scaling for all_numeric_predictors()\n```\n:::\n:::\n\n\n\nPreppen:\n\n\n::: {.cell hash='klassifikation_cache/html/rec1-prepped_4ab9fbfb57c04c4b61cfeff52c0a27d3'}\n\n```{.r .cell-code}\nrec1_prepped <- prep(rec1)\n```\n:::\n\n\nUnd backen:\n\n\n::: {.cell hash='klassifikation_cache/html/rec1-baked_77d9d0bd3a5afd6d50de7a41ade43a57'}\n\n```{.r .cell-code}\nd_rec1 <- bake(rec1_prepped, new_data = NULL)\n\nhead(d_rec1)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|id |c1      | tfidf_text__macmik| tfidf_text_2| tfidf_text_ab| tfidf_text_afd| tfidf_text_amp| tfidf_text_anna_iina| tfidf_text_athinamala| tfidf_text_beim| tfidf_text_besser| tfidf_text_bild| tfidf_text_cdu| tfidf_text_charlie_silv| tfidf_text_d| tfidf_text_daf√ºr| tfidf_text_dank| tfidf_text_dass| tfidf_text_deutsch| tfidf_text_deutschen| tfidf_text_deutschland| tfidf_text_dumm| tfidf_text_eigentlich| tfidf_text_einfach| tfidf_text_ellibisathid| tfidf_text_endlich| tfidf_text_ennof_| tfidf_text_erst| tfidf_text_eu| tfidf_text_europa| tfidf_text_feldenfrizz| tfidf_text_focusonlin| tfidf_text_frage| tfidf_text_frau| tfidf_text_ganz| tfidf_text_geht| tfidf_text_genau| tfidf_text_gerad| tfidf_text_gibt| tfidf_text_gr√ºnen| tfidf_text_gt| tfidf_text_gut| tfidf_text_heut| tfidf_text_immer| tfidf_text_info2099| tfidf_text_islam| tfidf_text_israel| tfidf_text_ja| tfidf_text_jahr| tfidf_text_klar| tfidf_text_kommt| tfidf_text_krippmari| tfidf_text_land| tfidf_text_lassen| tfidf_text_lbr| tfidf_text_leben| tfidf_text_leider| tfidf_text_lifetrend| tfidf_text_link| tfidf_text_macht| tfidf_text_machtjanix23| tfidf_text_mal| tfidf_text_md_franz| tfidf_text_mehr| tfidf_text_menschen| tfidf_text_merkel| tfidf_text_miriamozen| tfidf_text_moslem| tfidf_text_m√ºssen| tfidf_text_nancypeggymandi| tfidf_text_nasanas| tfidf_text_noherrman| tfidf_text_norbinator2403| tfidf_text_petpanther0| tfidf_text_politik| tfidf_text_recht| tfidf_text_richtig| tfidf_text_schmiddiemaik| tfidf_text_schon| tfidf_text_schulz| tfidf_text_seit| tfidf_text_sicher| tfidf_text_sollten| tfidf_text_spd| tfidf_text_tagesschau| tfidf_text_thomasgbau| tfidf_text_troll_putin| tfidf_text_trump| tfidf_text_tun| tfidf_text_u| tfidf_text_unser| tfidf_text_viel| tfidf_text_volk| tfidf_text_w√§re| tfidf_text_warum| tfidf_text_welt| tfidf_text_wer| tfidf_text_willjrosenblatt| tfidf_text_wissen| tfidf_text_wohl| tfidf_text_wurd| tfidf_text_zeit|\n|:--|:-------|------------------:|------------:|-------------:|--------------:|--------------:|--------------------:|---------------------:|---------------:|-----------------:|---------------:|--------------:|-----------------------:|------------:|----------------:|---------------:|---------------:|------------------:|--------------------:|----------------------:|---------------:|---------------------:|------------------:|-----------------------:|------------------:|-----------------:|---------------:|-------------:|-----------------:|----------------------:|---------------------:|----------------:|---------------:|---------------:|---------------:|----------------:|----------------:|---------------:|-----------------:|-------------:|--------------:|---------------:|----------------:|-------------------:|----------------:|-----------------:|-------------:|---------------:|---------------:|----------------:|--------------------:|---------------:|-----------------:|--------------:|----------------:|-----------------:|--------------------:|---------------:|----------------:|-----------------------:|--------------:|-------------------:|---------------:|-------------------:|-----------------:|---------------------:|-----------------:|-----------------:|--------------------------:|------------------:|--------------------:|-------------------------:|----------------------:|------------------:|----------------:|------------------:|------------------------:|----------------:|-----------------:|---------------:|-----------------:|------------------:|--------------:|---------------------:|---------------------:|----------------------:|----------------:|--------------:|------------:|----------------:|---------------:|---------------:|---------------:|----------------:|---------------:|--------------:|--------------------------:|-----------------:|---------------:|---------------:|---------------:|\n|7  |OFFENSE |         -0.1478606|   -0.1017932|    -0.1030146|      -0.157801|     -0.1237411|           -0.1069335|            -0.1421622|      -0.0952091|        -0.0970237|      -0.0999172|     -0.1136532|              -0.1446274|   -0.1331066|       -0.0923332|      -0.1187328|      -0.1907487|         -0.1557646|           -0.1525502|             -0.2023399|      -0.1038507|            -0.0936705|          -0.117269|              -0.1107154|         -0.0994985|         -0.113482|       -0.114578|     -0.115141|        -0.1053888|             -0.1478606|            -0.1057552|       -0.0935953|      -0.0936319|      -0.1104678|       3.9532756|       -0.0973827|       -0.1010069|      -0.1637995|        -0.1014353|    -0.0912218|     -0.1176659|       2.8693459|       -0.1583496|           -0.080984|       -0.1109831|        -0.0896051|     -0.170903|      -0.0974452|      -0.1010331|       -0.1001024|           -0.1374319|      -0.1395844|        -0.1036183|     -0.4078297|       -0.0885768|        -0.0958063|           -0.1433179|      -0.0988073|       -0.1261982|              -0.1072451|     -0.1802804|          -0.1309638|      -0.1873138|          -0.1223844|        -0.2228536|            -0.1091668|        -0.0953965|         -0.134878|                 -0.1110202|         -0.1191285|            -0.093113|                -0.0604024|             -0.0923776|         -0.1481462|       -0.1196747|         -0.1059602|               -0.1414784|       -0.1940836|         -0.098983|      -0.1269244|        -0.0922149|          -0.098992|     -0.1349804|            -0.1009173|            -0.1416992|             -0.1174202|       -0.1083908|     -0.1038686|   -0.1535957|       -0.1537918|      -0.1004169|      -0.1119121|      -0.1188893|       -0.1068939|      -0.1496574|     -0.1548429|                 -0.1414784|        -0.0910888|       -0.106692|      -0.1127138|       5.9093440|\n|9  |OFFENSE |         -0.1478606|   -0.1017932|    -0.1030146|       5.670118|     -0.1237411|           -0.1069335|            -0.1421622|      -0.0952091|        -0.0970237|      -0.0999172|     -0.1136532|              -0.1446274|   -0.1331066|       -0.0923332|      -0.1187328|      -0.1907487|         -0.1557646|           -0.1525502|             -0.2023399|      -0.1038507|            -0.0936705|          -0.117269|              -0.1107154|         -0.0994985|         -0.113482|       -0.114578|     -0.115141|        -0.1053888|             -0.1478606|            -0.1057552|       -0.0935953|      -0.0936319|      -0.1104678|      -0.1465598|       -0.0973827|       -0.1010069|      -0.1637995|        -0.1014353|    -0.0912218|     -0.1176659|      -0.1701938|       -0.1583496|           -0.080984|       -0.1109831|        -0.0896051|     -0.170903|      -0.0974452|      -0.1010331|       -0.1001024|           -0.1374319|      -0.1395844|        -0.1036183|     -0.4078297|       -0.0885768|        -0.0958063|           -0.1433179|      -0.0988073|       -0.1261982|              -0.1072451|     -0.1802804|          -0.1309638|      -0.1873138|          -0.1223844|        -0.2228536|            -0.1091668|        -0.0953965|         -0.134878|                 -0.1110202|         -0.1191285|            -0.093113|                -0.0604024|             -0.0923776|         -0.1481462|       -0.1196747|         -0.1059602|               -0.1414784|       -0.1940836|         -0.098983|      -0.1269244|        -0.0922149|          -0.098992|     -0.1349804|             9.1018767|            -0.1416992|             -0.1174202|       -0.1083908|     -0.1038686|   -0.1535957|       -0.1537918|      -0.1004169|      -0.1119121|      -0.1188893|       -0.1068939|      -0.1496574|     -0.1548429|                 -0.1414784|        -0.0910888|       -0.106692|      -0.1127138|      -0.1048312|\n|10 |OFFENSE |         -0.1478606|   -0.1017932|    -0.1030146|      -0.157801|     -0.1237411|           -0.1069335|            -0.1421622|      -0.0952091|        -0.0970237|      -0.0999172|     -0.1136532|              -0.1446274|   -0.1331066|       -0.0923332|      -0.1187328|      -0.1907487|         11.0326231|           -0.1525502|             -0.2023399|      -0.1038507|            -0.0936705|          -0.117269|              -0.1107154|         -0.0994985|         -0.113482|       -0.114578|     -0.115141|        -0.1053888|             -0.1478606|            -0.1057552|       -0.0935953|      -0.0936319|      -0.1104678|      -0.1465598|       -0.0973827|       -0.1010069|      -0.1637995|        -0.1014353|    -0.0912218|     -0.1176659|      -0.1701938|       -0.1583496|           -0.080984|       -0.1109831|        -0.0896051|     -0.170903|      -0.0974452|      -0.1010331|       -0.1001024|           -0.1374319|      -0.1395844|        -0.1036183|     -0.4078297|       -0.0885768|        -0.0958063|           -0.1433179|      -0.0988073|       -0.1261982|              -0.1072451|     -0.1802804|          -0.1309638|      -0.1873138|          -0.1223844|        -0.2228536|            -0.1091668|        -0.0953965|         -0.134878|                 -0.1110202|         -0.1191285|            -0.093113|                -0.0604024|             -0.0923776|         -0.1481462|       -0.1196747|         -0.1059602|               -0.1414784|       -0.1940836|         -0.098983|      -0.1269244|        -0.0922149|          -0.098992|     -0.1349804|            -0.1009173|            -0.1416992|             -0.1174202|       -0.1083908|     -0.1038686|   -0.1535957|       -0.1537918|      -0.1004169|      -0.1119121|      -0.1188893|       -0.1068939|      -0.1496574|     -0.1548429|                 -0.1414784|        -0.0910888|       -0.106692|      -0.1127138|      -0.1048312|\n|12 |OFFENSE |         -0.1478606|   -0.1017932|    -0.1030146|      -0.157801|     -0.1237411|           -0.1069335|            -0.1421622|      -0.0952091|        -0.0970237|      -0.0999172|     -0.1136532|              -0.1446274|   -0.1331066|       -0.0923332|      -0.1187328|      -0.1907487|         -0.1557646|           -0.1525502|             -0.2023399|      -0.1038507|            -0.0936705|          -0.117269|              -0.1107154|         -0.0994985|         -0.113482|       -0.114578|     -0.115141|        -0.1053888|             -0.1478606|            -0.1057552|       -0.0935953|      -0.0936319|      -0.1104678|      -0.1465598|       -0.0973827|       -0.1010069|      -0.1637995|        -0.1014353|    -0.0912218|     -0.1176659|      -0.1701938|        3.7091315|           -0.080984|       -0.1109831|        -0.0896051|      3.511705|      -0.0974452|      -0.1010331|       -0.1001024|           -0.1374319|      -0.1395844|        -0.1036183|      1.2316433|       -0.0885768|        -0.0958063|           -0.1433179|      -0.0988073|       -0.1261982|              -0.1072451|     -0.1802804|          -0.1309638|      -0.1873138|          -0.1223844|        -0.2228536|            -0.1091668|        -0.0953965|         -0.134878|                 -0.1110202|         -0.1191285|            -0.093113|                -0.0604024|             -0.0923776|         -0.1481462|       -0.1196747|         -0.1059602|               -0.1414784|       -0.1940836|         -0.098983|      -0.1269244|        -0.0922149|          -0.098992|     -0.1349804|            -0.1009173|            -0.1416992|             -0.1174202|       -0.1083908|     -0.1038686|   -0.1535957|       -0.1537918|      -0.1004169|      -0.1119121|      -0.1188893|       -0.1068939|      -0.1496574|     -0.1548429|                 -0.1414784|        -0.0910888|       -0.106692|      -0.1127138|      -0.1048312|\n|17 |OFFENSE |         -0.1478606|   -0.1017932|    -0.1030146|      -0.157801|     -0.1237411|           -0.1069335|            -0.1421622|      -0.0952091|        -0.0970237|      -0.0999172|     -0.1136532|              -0.1446274|   -0.1331066|       -0.0923332|      -0.1187328|      -0.1907487|         -0.1557646|            3.8058985|             -0.2023399|      -0.1038507|            -0.0936705|          -0.117269|              -0.1107154|         -0.0994985|         -0.113482|       -0.114578|     -0.115141|        -0.1053888|             -0.1478606|            -0.1057552|       -0.0935953|      -0.0936319|      -0.1104678|      -0.1465598|       -0.0973827|       -0.1010069|      -0.1637995|        -0.1014353|    -0.0912218|     -0.1176659|      -0.1701938|       -0.1583496|           -0.080984|       -0.1109831|        -0.0896051|     -0.170903|      -0.0974452|      -0.1010331|       -0.1001024|           -0.1374319|      -0.1395844|        -0.1036183|     -0.4078297|       -0.0885768|        -0.0958063|           -0.1433179|      -0.0988073|       -0.1261982|              -0.1072451|     -0.1802804|          -0.1309638|      -0.1873138|          -0.1223844|        -0.2228536|            -0.1091668|        -0.0953965|         -0.134878|                 -0.1110202|         -0.1191285|            -0.093113|                -0.0604024|             -0.0923776|          4.3487918|       -0.1196747|         -0.1059602|               -0.1414784|       -0.1940836|         -0.098983|       4.6618704|        -0.0922149|          -0.098992|     -0.1349804|            -0.1009173|            -0.1416992|             -0.1174202|       -0.1083908|     -0.1038686|   -0.1535957|       -0.1537918|      -0.1004169|      -0.1119121|      -0.1188893|       -0.1068939|      -0.1496574|     -0.1548429|                 -0.1414784|        -0.0910888|       -0.106692|      -0.1127138|      -0.1048312|\n|33 |OFFENSE |         -0.1478606|   -0.1017932|    -0.1030146|      -0.157801|     -0.1237411|           -0.1069335|            -0.1421622|      -0.0952091|        -0.0970237|      -0.0999172|     -0.1136532|              -0.1446274|   -0.1331066|       -0.0923332|      -0.1187328|      -0.1907487|          3.5736979|           -0.1525502|             -0.2023399|      -0.1038507|            -0.0936705|          -0.117269|              -0.1107154|         -0.0994985|         -0.113482|       -0.114578|     -0.115141|        -0.1053888|             -0.1478606|            -0.1057552|       -0.0935953|      -0.0936319|      -0.1104678|      -0.1465598|       -0.0973827|       -0.1010069|      -0.1637995|        -0.1014353|    -0.0912218|     -0.1176659|      -0.1701938|       -0.1583496|           -0.080984|       -0.1109831|        -0.0896051|     -0.170903|      -0.0974452|      -0.1010331|       -0.1001024|           -0.1374319|      -0.1395844|        -0.1036183|     -0.4078297|       -0.0885768|        -0.0958063|           -0.1433179|      -0.0988073|       -0.1261982|              -0.1072451|     -0.1802804|          -0.1309638|       2.9994252|          -0.1223844|        -0.2228536|            -0.1091668|         6.1140871|         -0.134878|                 -0.1110202|         -0.1191285|            -0.093113|                -0.0604024|             -0.0923776|         -0.1481462|       -0.1196747|         -0.1059602|               -0.1414784|       -0.1940836|         -0.098983|      -0.1269244|        -0.0922149|          -0.098992|     -0.1349804|            -0.1009173|            -0.1416992|             -0.1174202|       -0.1083908|     -0.1038686|   -0.1535957|       -0.1537918|      -0.1004169|      -0.1119121|      -0.1188893|       -0.1068939|      -0.1496574|     -0.1548429|                 -0.1414784|        -0.0910888|       -0.106692|      -0.1127138|      -0.1048312|\n\n</div>\n:::\n:::\n\n\n\n\n### Modellspezifikation 1\n\nWir definiere einen Naive-Bayes-Algorithmus:\n\n\n::: {.cell hash='klassifikation_cache/html/nb-spec_a7791b89b490498e0e4012c733f7328e'}\n\n```{.r .cell-code}\nnb_spec <- naive_Bayes() %>%\n  set_mode(\"classification\") %>%\n  set_engine(\"naivebayes\")\n\nnb_spec\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nNaive Bayes Model Specification (classification)\n\nComputational engine: naivebayes \n```\n:::\n:::\n\n\n\n\nUnd setzen auf die klassische zehnfache Kreuzvalidierung.\n\n\n\n::: {.cell hash='klassifikation_cache/html/folds1_b3892f13a41b2929c825b89d84c66d8c'}\n\n```{.r .cell-code}\nset.seed(42)\nfolds1 <- vfold_cv(d_train)\n```\n:::\n\n\n\n\n### Workflow 1\n\n\n\n::: {.cell hash='klassifikation_cache/html/wf1_e72c4ba077f687919fd19f44ec6270be'}\n\n```{.r .cell-code}\nwf1 <-\n  workflow() %>% \n  add_recipe(rec1) %>% \n  add_model(nb_spec)\n\nwf1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n‚ïê‚ïê Workflow ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nPreprocessor: Recipe\nModel: naive_Bayes()\n\n‚îÄ‚îÄ Preprocessor ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n6 Recipe Steps\n\n‚Ä¢ step_tokenize()\n‚Ä¢ step_stopwords()\n‚Ä¢ step_stem()\n‚Ä¢ step_tokenfilter()\n‚Ä¢ step_tfidf()\n‚Ä¢ step_normalize()\n\n‚îÄ‚îÄ Model ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nNaive Bayes Model Specification (classification)\n\nComputational engine: naivebayes \n```\n:::\n:::\n\n\n\n### Fitting 1\n\n\n\n::: {.cell hash='klassifikation_cache/html/fit1_328969f3ab8f347fdb510934be5cc1ba'}\n\n```{.r .cell-code}\nfit1 <-\n  fit_resamples(\n    wf1,\n    folds1,\n    control = control_resamples(save_pred = TRUE)\n  )\n```\n:::\n\n\nDie Vorhersagen speichern wir ab,\num die Performanz in den Faltungen des Hold-out-Samples zu berechnen.\n\n\nM√∂chte man sich die Zeit sparen, die Syntax wieder durchlaufen zu lassen,\nkann man das Objekt speichern. \nAber Vorsicht: Dabei kann es passieren, dass man mit veralteten Objekten arbeitet.\n\n\n\n\n::: {.cell hash='klassifikation_cache/html/write-fit1_17e4fa797ad70becfb22ef63a31db7df'}\n\n```{.r .cell-code}\n#write_rds(fit1, \"objects/chap_classific_fit1.rds\")\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/read-fit1_db8cda8f55020b1d50431c737904ef67'}\n\n:::\n\n\n\n\n### Performanz 1\n\n\n::: {.cell hash='klassifikation_cache/html/wf1-perf_3811d11fb3139d008e377f589ac8ba58'}\n\n```{.r .cell-code}\nwf1_performance <-\n  collect_metrics(fit1)\n\nwf1_performance\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/wf1-preds_9e5a96ca972fd7ae2a9a70142a6d0d43'}\n\n```{.r .cell-code}\nwf_preds <-\n  collect_predictions(fit1)\n\nwf_preds %>% \n  group_by(id) %>% \n  roc_curve(truth = c1, .pred_OFFENSE) %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](klassifikation_files/figure-html/wf1-preds-1.png){width=672}\n:::\n:::\n\n\n\nconf_mat_resampled(fit1, tidy = FALSE) %>% \n  autoplot(type = \"heatmap\")\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-14_34cf3206921351db65f50ae9299c0f12'}\n\n```{.r .cell-code}\nconf_mat_resampled(fit1, tidy = FALSE) %>% \n  autoplot(type = \"heatmap\")\n```\n\n::: {.cell-output-display}\n![](klassifikation_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## Nullmodell\n\n\n\n::: {.cell hash='klassifikation_cache/html/nullmodel_b690571da86498d71a6bb535a17f8ebd'}\n\n```{.r .cell-code}\nnull_classification <- \n  parsnip::null_model() %>%\n  set_engine(\"parsnip\") %>%\n  set_mode(\"classification\")\n\nnull_rs <- workflow() %>%\n  add_recipe(rec1) %>%\n  add_model(null_classification) %>%\n  fit_resamples(\n    folds1\n  )\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-15_9eaae3268dabb5bbe6524a00bb009e74'}\n\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-16_78e01e01d9f10f78281938d554c8d896'}\n\n:::\n\n\n\n\nHier ist die Performanz des Nullmodells.\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-17_68c3ad849a21ac4e7894adb987c2340b'}\n\n```{.r .cell-code}\nnull_rs %>%\n  collect_metrics()\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-18_aca814f9369660302649b7b2d857dfbc'}\n\n```{.r .cell-code}\nshow_best(null_rs)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: No value of `metric` was given; metric 'roc_auc' will be used.\n```\n:::\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|   penalty|.metric |.estimator |      mean|  n|   std_err|.config               |\n|---------:|:-------|:----------|---------:|--:|---------:|:---------------------|\n| 0.0017433|roc_auc |binary     | 0.8116297| 10| 0.0087106|Preprocessor1_Model22 |\n| 0.0007880|roc_auc |binary     | 0.8111630| 10| 0.0089414|Preprocessor1_Model21 |\n| 0.0003562|roc_auc |binary     | 0.8103737| 10| 0.0092381|Preprocessor1_Model20 |\n| 0.0001610|roc_auc |binary     | 0.8099159| 10| 0.0094448|Preprocessor1_Model19 |\n| 0.0000000|roc_auc |binary     | 0.8095907| 10| 0.0096029|Preprocessor1_Model01 |\n\n</div>\n:::\n:::\n\n\n\n\n\n## Workflow 2: Rezept 1 + Lasso\n\n\n\n\n::: {.cell hash='klassifikation_cache/html/lasso-spec_a3aec9ef905b014eab24150902bf3f0c'}\n\n```{.r .cell-code}\nlasso_spec <- logistic_reg(penalty = tune(), mixture = 1) %>%\n  set_mode(\"classification\") %>%\n  set_engine(\"glmnet\")\n\nlasso_spec\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLogistic Regression Model Specification (classification)\n\nMain Arguments:\n  penalty = tune()\n  mixture = 1\n\nComputational engine: glmnet \n```\n:::\n:::\n\n\n\n\nWir definieren die Auspr√§gungen von `penalty`, \ndie wir ausprobieren wollen:\n\n\n\n::: {.cell hash='klassifikation_cache/html/lambda-grid_8de6cb6493a29c311c6d5359f8860aeb'}\n\n```{.r .cell-code}\nlambda_grid <- grid_regular(penalty(), levels = 3)  # hier nur 3 Werte, um Rechenzeit zu sparen\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/wf2_d7cd23d180dba6309eb8d24a4268d4e6'}\n\n```{.r .cell-code}\nwf2 <-\n  workflow() %>% \n  add_recipe(rec1) %>% \n  add_model(lasso_spec)\n\nwf2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n‚ïê‚ïê Workflow ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nPreprocessor: Recipe\nModel: logistic_reg()\n\n‚îÄ‚îÄ Preprocessor ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n6 Recipe Steps\n\n‚Ä¢ step_tokenize()\n‚Ä¢ step_stopwords()\n‚Ä¢ step_stem()\n‚Ä¢ step_tokenfilter()\n‚Ä¢ step_tfidf()\n‚Ä¢ step_normalize()\n\n‚îÄ‚îÄ Model ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nLogistic Regression Model Specification (classification)\n\nMain Arguments:\n  penalty = tune()\n  mixture = 1\n\nComputational engine: glmnet \n```\n:::\n:::\n\n\n\nTunen und Fitten:\n\n\n::: {.cell hash='klassifikation_cache/html/fit2_72d0763e5fb111902bb4886c7c4a1b28'}\n\n```{.r .cell-code}\nset.seed(42)\n\nfit2 <-\n  tune_grid(\n    wf2,\n    folds1,\n    grid = lambda_grid,\n    control = control_resamples(save_pred = TRUE)\n  )\n\nfit2\n```\n:::\n\n\n\nVorsicht beim Abspeichern.\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-19_ca0f70cfb52306d68e8cbc5b71f760e2'}\n\n```{.r .cell-code}\n#write_rds(fit2, \"objects/chap_classific_fit2.rds\")\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/read-fit2_2588060668926c80c2d7bc67ff0a6553'}\n\n:::\n\n\n\n\nHier ist die Performanz:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-20_6c761539fa322ee527124f3ad3eee639'}\n\n```{.r .cell-code}\ncollect_metrics(fit2) %>% \n  filter(.metric == \"roc_auc\") %>% \n  slice_max(mean, n = 3)\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-21_315336d71aaf37e663d3f45ebd5cba19'}\n\n```{.r .cell-code}\nautoplot(fit2)\n```\n\n::: {.cell-output-display}\n![](klassifikation_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-22_86373b8d020b9f2ae33030344d8031e4'}\n\n```{.r .cell-code}\nfit2 %>% \n  show_best(\"roc_auc\")\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n| penalty|.metric |.estimator |      mean|  n|   std_err|.config               |\n|-------:|:-------|:----------|---------:|--:|---------:|:---------------------|\n|       0|roc_auc |binary     | 0.5997476| 10| 0.0090575|Preprocessor1_Model01 |\n|       0|roc_auc |binary     | 0.5997476| 10| 0.0090575|Preprocessor1_Model02 |\n|       0|roc_auc |binary     | 0.5997476| 10| 0.0090575|Preprocessor1_Model03 |\n|       0|roc_auc |binary     | 0.5997476| 10| 0.0090575|Preprocessor1_Model04 |\n|       0|roc_auc |binary     | 0.5997476| 10| 0.0090575|Preprocessor1_Model05 |\n\n</div>\n:::\n:::\n\n::: {.cell hash='klassifikation_cache/html/chosen-auc-fit2_f25fa5cfdd99153c2a62003420ec98f3'}\n\n```{.r .cell-code}\nchosen_auc <- \n  fit2 %>%\n  select_by_one_std_err(metric = \"roc_auc\", -penalty)\n```\n:::\n\n\n\n\nFinalisieren:\n\n\n\n::: {.cell hash='klassifikation_cache/html/wf2-final_216ce62197475b9a9cd6027de21d075c'}\n\n```{.r .cell-code}\nwf2_final <-\n  finalize_workflow(wf2, chosen_auc)\n\nwf2_final\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n‚ïê‚ïê Workflow ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nPreprocessor: Recipe\nModel: logistic_reg()\n\n‚îÄ‚îÄ Preprocessor ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n6 Recipe Steps\n\n‚Ä¢ step_tokenize()\n‚Ä¢ step_stopwords()\n‚Ä¢ step_stem()\n‚Ä¢ step_tokenfilter()\n‚Ä¢ step_tfidf()\n‚Ä¢ step_normalize()\n\n‚îÄ‚îÄ Model ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nLogistic Regression Model Specification (classification)\n\nMain Arguments:\n  penalty = 0.00853167852417281\n  mixture = 1\n\nComputational engine: glmnet \n```\n:::\n:::\n\n::: {.cell hash='klassifikation_cache/html/fit2-final-train_d2071737f7c1acf60b93ee6664042cab'}\n\n```{.r .cell-code}\nfit2_final_train <-\n  fit(wf2_final, d_train)\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-23_38c02dc9c3a459a0e85662b814784b48'}\n\n```{.r .cell-code}\nfit2_final_train %>% \n  extract_fit_parsnip() %>% \n  tidy() %>% \n  arrange(-abs(estimate)) %>% \n  head()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: Matrix\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'Matrix'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoaded glmnet 4.1-6\n```\n:::\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|term              |   estimate|   penalty|\n|:-----------------|----------:|---------:|\n|(Intercept)       |  0.7002844| 0.0085317|\n|tfidf_text_merkel | -0.2356021| 0.0085317|\n|tfidf_text_dumm   | -0.1908203| 0.0085317|\n|tfidf_text_lbr    | -0.1468066| 0.0085317|\n|tfidf_text_moslem | -0.1442941| 0.0085317|\n|tfidf_text_dank   |  0.1295210| 0.0085317|\n\n</div>\n:::\n:::\n\n::: {.cell hash='klassifikation_cache/html/fit2-final-test_c575137863264e8190e03ee8e269f361'}\n\n```{.r .cell-code}\nfit2_final_test <-\n  last_fit(wf2_final, d_split)\n\ncollect_metrics(fit2_final_test)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|.metric  |.estimator | .estimate|.config              |\n|:--------|:----------|---------:|:--------------------|\n|accuracy |binary     | 0.6855547|Preprocessor1_Model1 |\n|roc_auc  |binary     | 0.6448264|Preprocessor1_Model1 |\n\n</div>\n:::\n:::\n\n\n\n\n### Vorhersage\n\n\n### Vohersagedaten\n\nPfad zu den Daten:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-24_34f456cbc0bc29da8d7d54580277ffa2'}\n\n```{.r .cell-code}\ntweet_data_path <- \"/Users/sebastiansaueruser/github-repos/hate-speech/data-raw/tweets/\"\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-25_8791c5bb521e6e0015013f0971b3a461'}\n\n```{.r .cell-code}\ntweet_data_files_names <- list.files(path = tweet_data_path,\n                                     pattern  = \"tweets-to-.*\\\\.rds$\")\nhead(tweet_data_files_names)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncharacter(0)\n```\n:::\n:::\n\n\n\nWie viele Dateien sind es?\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-26_a9d2e47343b5226ef247e16912a40da7'}\n\n```{.r .cell-code}\nlength(tweet_data_files_names)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n:::\n\n\n\nWir geben den Elementen des Vektors g√§ngige Namen,\ndas hilft uns gleich bei `map`:\n\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-27_33f5962b91682747f0810bf7c64bd4cc'}\n\n```{.r .cell-code}\nnames(tweet_data_files_names) <- str_remove(tweet_data_files_names, \"\\\\.rds\")\n```\n:::\n\n\n\n\n\n\nOK, weiter: So k√∂nnen wir *eine* der Datendateien einlesen:\n\n\n::: {.cell hash='klassifikation_cache/html/read-tweets_990ac0b11895c066c9252712db69d261'}\n\n```{.r .cell-code}\nd_raw <-\n  read_rds(file = paste0(tweet_data_path, tweet_data_files_names[1])) \n\nd <- \n  d_raw %>% \n  select(id, author_id, created_at, public_metrics) %>% \n  unnest_wider(public_metrics)\n\nhead(d)\n```\n:::\n\n\n\nUnd so lesen wir alle ein:\n\n\nZun√§chst erstellen wir uns eine Helper-Funktion:\n\n\n\n::: {.cell hash='klassifikation_cache/html/fun-read-and-select_a29abe2945bdbc6943603487c9d1c089'}\n\n```{.r .cell-code}\nread_and_select <- function(file_name, path_to_tweet_data = tweet_data_path) {\n  \n  out <- \n    read_rds(file = paste0(path_to_tweet_data, file_name)) %>% \n    select(id, author_id, created_at, text, public_metrics) %>% \n    unnest_wider(public_metrics)\n  \n  cat(\"Data file was read.\\n\")\n  \n  return(out)\n}\n```\n:::\n\n\nTesten:\n\n\n::: {.cell hash='klassifikation_cache/html/read-and-seelct-test_ce59829c5f29f605c8c90f3d9190dc91'}\n\n```{.r .cell-code}\nd1 <- read_and_select(tweet_data_files_names[1])\n\nhead(d1)\n```\n:::\n\n\n\n\nDie Funktion `read_and_select`  mappen wir auf alle Datendateien:\n\n\n\n::: {.cell hash='klassifikation_cache/html/map-read-and-select_aeaddc7e47ba8c59fc580347ac6204c3'}\n\n```{.r .cell-code}\ntic()\nds <-\n  tweet_data_files_names %>% \n  map_dfr(read_and_select, .id = \"dataset\")\ntoc()\n```\n:::\n\n\n\n`214.531 sec elapsed`\n\nDa wir den Elementen von `tweet_data_files_names` Namen gegeben haben, \nfinden wir diese Namen praktischerweise wieder in `ds`.\n\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-28_46b88eb7950157c9e2e78dbfcd921dad'}\n\n:::\n\n::: {.cell hash='klassifikation_cache/html/read-ds_709a0a765c198753d2065ed31a4ce3ec'}\n\n:::\n\n\n\n\n\nVielleicht ist es zum Entwickeln besser,\nmit einem kleineren Datensatz einstweilen zu arbeiten:\n\n\n::: {.cell hash='klassifikation_cache/html/ds-short_663be426e21ad5e165b31e6b761e250c'}\n\n```{.r .cell-code}\nds_short <- read_rds(file = \"/Users/sebastiansaueruser/datasets/Twitter/hate-classific/ds_short.rds\")\n\nds <- ds_short\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-29_642b0e04bcdf2ab22c793b5d844fa3b3'}\n\n:::\n\n\n\n\n\n### Vokabular erstellen\n\n\n\n::: {.cell hash='klassifikation_cache/html/ds-long_9a59a699b11568c41e8923bf03bdefa8'}\n\n```{.r .cell-code}\nds_long <-\n  ds %>% \n  select(text) %>% \n  unnest_tweets(input = text, output = word)\n```\n:::\n\n\nPuh, das hat gedauert!\n\nSpeichern wir uns diese Daten daher auf die Festplatte:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-30_95793f695e079f122f4ece0bc0cea971'}\n\n```{.r .cell-code}\n#write_rds(ds_long, file = paste0(tweet_data_path, \"ds_long.rds\"))\n```\n:::\n\n\nEntfernen wir daraus die Duplikate,\num uns ein Vokabular zu erstellen:\n\n\n::: {.cell hash='klassifikation_cache/html/ds-voc_ed7ff8c0f6428d45d968d84d2e137ef6'}\n\n```{.r .cell-code}\nds_voc <-\n  ds_long %>% \n  distinct(word)\n```\n:::\n\n\nUnd das resultierende Objekt speichern wir wieder ab:\n\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-31_9c7dd84748aae35112b7243f1f8e02cd'}\n\n```{.r .cell-code}\n#write_rds(ds_voc, file = paste0(\"objects/\", \"ds_voc.rds\"))\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-32_2bf9a22f5bee27e6f4d6dfa58b3d4686'}\n\n:::\n\n\n\n\n\n\n## Worteinbettungen erstellen\n\n\n### FastText-Modell {#sec-fasttext}\n\nDefiniere die Konstanten f√ºr das fastText-Modell:\n\n\n::: {.cell hash='klassifikation_cache/html/fastText-constants_26b917cd79da8c4033508ecd2cd5aaf3'}\n\n```{.r .cell-code}\ntexts <- ds %>% pull(text)\ntexts <- tolower(texts)\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/fastText-filenames_47330a1fb508d3f2033243e609d605e8'}\n\n```{.r .cell-code}\nout_file_txt <- \"/Users/sebastiansaueruser/datasets/Twitter/twitter-polit-model.vec\"\nout_file_model <- \"/Users/sebastiansaueruser/datasets/Twitter/twitter-polit-model.bin\"\n\nfile.exists(out_file_txt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\nfile.exists(out_file_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n::: {.cell hash='klassifikation_cache/html/fasttext-modell_e36395389026076001e1f28b05666208'}\n\n```{.r .cell-code}\n#writeLines(text = texts, con = out_file_txt)\n#execute(commands = c(\"skipgram\", \"-input\", tmp_file_txt, \"-output\", out_file_model, \"-verbose\", 1))\n```\n:::\n\n\n\n```\nRead 22M words\nNumber of words:  130328\nNumber of labels: 0\nProgress: 100.0% words/sec/thread:   49218 lr:  0.000000 avg.loss:  1.720812 ETA:   0h 0m 0s\n```\n\nJetzt laden wir das Modell von der Festplatte:\n\n\n::: {.cell hash='klassifikation_cache/html/twitter-fasttext-model_2f97c32425b459022dae51cf7b682554'}\n\n```{.r .cell-code}\ntwitter_fasttext_model <- load_model(out_file_model)\ndict <- get_dictionary(twitter_fasttext_model)\n```\n:::\n\n\n\nSchauen wir uns einige Begriffe aus dem Vokabular an:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-33_872fb2a99621f991ff4c38222b0972b2'}\n\n```{.r .cell-code}\nprint(head(dict, 10))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"</s>\"            \"die\"             \"und\"             \"der\"            \n [5] \"sie\"             \"das\"             \"nicht\"           \"in\"             \n [9] \"ist\"             \"@_friedrichmerz\"\n```\n:::\n:::\n\n\nHier sind die ersten paar Elemente des Vektors f√ºr `menschen`:\n\n\n\n::: {.cell hash='klassifikation_cache/html/vector-menschen_2f9a9505c385f3dbeade4b7e1ddf3fac'}\n\n```{.r .cell-code}\nget_word_vectors(twitter_fasttext_model, c(\"menschen\")) %>% `[`(1:10)\n```\n:::\n\n\n\n```\n [1]  0.14156282  0.44875699  0.23911817 -0.02580349  0.29811972  0.03870077\n [7]  0.06518744  0.22527063  0.28198120  0.39931887\n ```\n\n\nErstellen wir uns einen Tibble, der \nals erste Spalte das Vokabular und in den √ºbrigen 100 Spalten die Dimensionen enth√§lt:\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-34_1ca8d6c0944dfc0f40c3a0c841097b55'}\n\n```{.r .cell-code}\nword_embedding_twitter <-\n  tibble(\n    word = dict\n  )\n```\n:::\n\n\n\n::: {.cell hash='klassifikation_cache/html/words-vec-twitter_68a582ec380b02004c2b50cd750e9340'}\n\n```{.r .cell-code}\nwords_vecs_twitter <-\n  get_word_vectors(twitter_fasttext_model)\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/df-word-embedding-twitter_8dda266018d3a61d4321f7b610d52ebc'}\n\n```{.r .cell-code}\nword_embedding_twitter <-\n  word_embedding_twitter %>% \n  bind_cols(words_vecs_twitter)\n\nnames(word_embedding_twitter) <- c(\"word\", paste0(\"v\", sprintf(\"%03d\", 1:100)))  # Namen versch√∂nern\n```\n:::\n\n\n\nUnd als Worteinbettungs-Datei abspeichern:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-35_66da11e7e2b9f55fbc60f8f218850a84'}\n\n```{.r .cell-code}\n#write_rds(word_embedding_twitter, file = paste0(tweet_data_path, \"word_embedding_twitter.rds\"))\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-36_f56c6d34a73919560bf2a73f849ef1f8'}\n\n:::\n\n\n\n\n### Aufbereiten\n\nAm besten nur die Spalten behalten,\ndie wir zum Modellieren nutzen:\n\n\n::: {.cell hash='klassifikation_cache/html/ds-short2_af311d5a1144cffc658e173130588d21'}\n\n```{.r .cell-code}\nds_short2 <-\n  ds_short %>% \n  select(text, id)\n```\n:::\n\n\n\nDann backen wir die Daten mit dem vorhandenen Rezept:\n\n\n\n\n::: {.cell hash='klassifikation_cache/html/ds-baked_e60c03b90fbf7466f351b1dcff8da245'}\n\n```{.r .cell-code}\nds_baked <- bake(rec1_prepped, new_data = ds_short2)\n```\n:::\n\n\n\nIst das nicht komfortabel?\nDas Textrezept √ºbernimmt die Arbeit f√ºr uns,\nmit den richtigen Features zu arbeiten,\ndie tf-idfs f√ºr die richtigen Tokens zu berechnen.\n\nWer dem Frieden nicht traut,\ndem sei geraten, nachzupr√ºfen :-)\n\n\n\n## Workflow 3: Rezept 2 + Lasso\n\n### Daten aufteilen\n\n\n\n\n::: {.cell hash='klassifikation_cache/html/split-data3_284178b7689c029dae98e7eff9cb245c'}\n\n```{.r .cell-code}\nd_split <- initial_split(d2, strata = c1)\n\nd_train <- training(d_split)\nd_test <- testing(d_split)\n```\n:::\n\n\n\n\n### Hilfsfunktionen\n\n\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-37_e11f7266acdcf67a0935f31a05a0ae13'}\n\n```{.r .cell-code}\nsource(\"funs/helper-funs-recipes.R\")\n```\n:::\n\n\n\n\nTesten wir die Funktionen:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-38_f82ccacfb5f976c11129c83927e49995'}\n\n```{.r .cell-code}\ndummy <- c(\"hallo\", \"baby\", \"fatal\")\n\ncount_profane(dummy) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1\n```\n:::\n\n```{.r .cell-code}\ncount_emo_words(dummy)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1\n```\n:::\n\n```{.r .cell-code}\ndummy <- c(\"baby\", \"und\", \"üÜó\", \"üñï\")\n\ncount_emojis(dummy)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1\n```\n:::\n\n```{.r .cell-code}\ncount_wild_emojis(dummy) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1\n```\n:::\n:::\n\n\n\n### Rezept mit Worteinbettungen\n\n\n::: {.cell hash='klassifikation_cache/html/rec2_13e90d8dd5346b790b20de9311324250'}\n\n```{.r .cell-code}\nrec2 <- \n  recipe(c1 ~ ., data = select(d_train, text, c1, id)) %>% \n  update_role(id, new_role = \"id\") %>% \n  step_text_normalization(text) %>% \n  step_mutate(text_copy = text,\n              profane_n = map_int(text, count_profane),\n              emo_words_n = map_int(text, count_emo_words),\n              emojis_n = map_int(text, count_emojis),\n              wild_emojis_n = map_int(text, count_wild_emojis)\n  ) %>% \n  step_textfeature(text_copy) %>% \n  step_tokenize(text, token = \"tweets\") %>% \n  step_stopwords(text, language = \"de\", stopword_source = \"snowball\") %>% \n  step_word_embeddings(text, embeddings = word_embedding_twitter)\n \nrec2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRecipe\n\nInputs:\n\n      role #variables\n        id          1\n   outcome          1\n predictor          1\n\nOperations:\n\nText Normalization for text\nVariable mutation for text, map_int(text, count_profane), map_in...\nText feature extraction for text_copy\nTokenization for text\nStop word removal for text\nWord embeddings aggregated from text\n```\n:::\n:::\n\n\n\n\n\nJetzt preppen:\n\n\n\n::: {.cell hash='klassifikation_cache/html/rec2-prepped_3c805b426a3778870cbe3e21830f5636'}\n\n```{.r .cell-code}\nrec2_prepped <- prep(rec2)\n```\n:::\n\n\n\nVielleicht macht es Sinn, sich das Objekt zur sp√§teren\nVerwendung abzuspeichern.^[Aber Vorsicht beim Abspeichern, man k√∂nnte versehentlich mit einer veralteten Version weiterarbeiten.]\n`Feather` verarbeitet nur Dataframes,\ndaher nutzen wir hier RDS.\n\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-39_aac0383b661bbc8a81dcaa8c5c6b5269'}\n\n```{.r .cell-code}\n#write_rds(rec2_prepped, file = \"~/datasets/Twitter/klassifik-rec2-prepped.rds\")\n```\n:::\n\n\n\n\nDas Element `rec2_prepped` ist recht gro√ü:\n\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-40_e03353b5216ea9fb8a764f685f0c5334'}\n\n```{.r .cell-code}\nformat(object.size(rec2_prepped), units  = \"Mb\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"113.8 Mb\"\n```\n:::\n:::\n\n\nJetzt k√∂nnen wir das pr√§parierte (\"gepreppte\") Rezept \"backen\":\n\n\n\n::: {.cell hash='klassifikation_cache/html/rec2-prepped-baked_59533a497dbc47a631ad64b4b21e219a'}\n\n```{.r .cell-code}\nrec2_baked <- bake(rec2_prepped, new_data = NULL)\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-41_b80a59d31a6a02ce439e4fc3fe48c004'}\n\n```{.r .cell-code}\nrec2_baked %>% \n  select(1:15) %>% \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 3,756\nColumns: 15\n$ id                                  <fct> 5, 7, 10, 12, 17, 27, 33, 42, 44, ‚Ä¶\n$ c1                                  <fct> OFFENSE, OFFENSE, OFFENSE, OFFENSE‚Ä¶\n$ profane_n                           <int> 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0‚Ä¶\n$ emo_words_n                         <int> 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1‚Ä¶\n$ emojis_n                            <int> 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0‚Ä¶\n$ wild_emojis_n                       <int> 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0‚Ä¶\n$ textfeature_text_copy_n_words       <int> 16, 32, 15, 26, 19, 15, 33, 30, 31‚Ä¶\n$ textfeature_text_copy_n_uq_words    <int> 16, 28, 15, 25, 17, 15, 32, 29, 29‚Ä¶\n$ textfeature_text_copy_n_charS       <int> 121, 145, 119, 134, 112, 101, 196,‚Ä¶\n$ textfeature_text_copy_n_uq_charS    <int> 31, 29, 30, 39, 36, 31, 35, 42, 35‚Ä¶\n$ textfeature_text_copy_n_digits      <int> 0, 4, 0, 2, 4, 0, 0, 0, 1, 0, 2, 0‚Ä¶\n$ textfeature_text_copy_n_hashtags    <int> 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0‚Ä¶\n$ textfeature_text_copy_n_uq_hashtags <int> 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0‚Ä¶\n$ textfeature_text_copy_n_mentions    <int> 1, 1, 0, 1, 0, 1, 1, 5, 1, 0, 1, 1‚Ä¶\n$ textfeature_text_copy_n_uq_mentions <int> 1, 1, 0, 1, 0, 1, 1, 5, 1, 0, 1, 1‚Ä¶\n```\n:::\n:::\n\n\n\n\n### Fitting 3 {#sec-klassifik-fit3}\n\n\n\n\n\n::: {.cell hash='klassifikation_cache/html/wf3_1ea87c63019fb4bc1ba67c3156c57ddd'}\n\n```{.r .cell-code}\nwf3 <-\n  workflow() %>% \n  add_recipe(rec2) %>% \n  add_model(lasso_spec)\n\nwf3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n‚ïê‚ïê Workflow ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nPreprocessor: Recipe\nModel: logistic_reg()\n\n‚îÄ‚îÄ Preprocessor ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n6 Recipe Steps\n\n‚Ä¢ step_text_normalization()\n‚Ä¢ step_mutate()\n‚Ä¢ step_textfeature()\n‚Ä¢ step_tokenize()\n‚Ä¢ step_stopwords()\n‚Ä¢ step_word_embeddings()\n\n‚îÄ‚îÄ Model ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nLogistic Regression Model Specification (classification)\n\nMain Arguments:\n  penalty = tune()\n  mixture = 1\n\nComputational engine: glmnet \n```\n:::\n:::\n\n\n\n\n\n\nTunen und Fitten:\n\n\n::: {.cell hash='klassifikation_cache/html/wf3-fit_758cef2da1566f33e6bb3939df4e28ce'}\n\n```{.r .cell-code}\nset.seed(42)\n\ntic()\nfit3 <-\n  tune_grid(\n    wf3,\n    folds1,\n    grid = lambda_grid,\n    control = control_resamples(save_pred = TRUE)\n  )\n(toc)\nfit3\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-42_9d91c9bd8c68eeab21ea6f4525a65a7b'}\n\n```{.r .cell-code}\n#write_rds(fit3, \"objects/chap_classific_fit3.rds\")\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-43_b0a10368b19c84936c074bf97afa9fdc'}\n\n:::\n\n\n\n\nHier ist die Performanz:\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-44_384b2ea6e44699edee6a5fb787b7d6ae'}\n\n```{.r .cell-code}\ncollect_metrics(fit3)\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-45_39e6d0de48384c69d88580f772b71530'}\n\n```{.r .cell-code}\nautoplot(fit3)\n```\n\n::: {.cell-output-display}\n![](klassifikation_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-46_a5f64b6e3d2d355b64024711a158c1ca'}\n\n```{.r .cell-code}\nfit3 %>% \n  show_best(\"roc_auc\")\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|   penalty|.metric |.estimator |      mean|  n|   std_err|.config               |\n|---------:|:-------|:----------|---------:|--:|---------:|:---------------------|\n| 0.0017433|roc_auc |binary     | 0.8116297| 10| 0.0087106|Preprocessor1_Model22 |\n| 0.0007880|roc_auc |binary     | 0.8111630| 10| 0.0089414|Preprocessor1_Model21 |\n| 0.0003562|roc_auc |binary     | 0.8103737| 10| 0.0092381|Preprocessor1_Model20 |\n| 0.0001610|roc_auc |binary     | 0.8099159| 10| 0.0094448|Preprocessor1_Model19 |\n| 0.0000000|roc_auc |binary     | 0.8095907| 10| 0.0096029|Preprocessor1_Model01 |\n\n</div>\n:::\n:::\n\n::: {.cell hash='klassifikation_cache/html/chosenauc-fit3_c25e5e9f32430a0b8159dac8698641ba'}\n\n```{.r .cell-code}\nchosen_auc_fit3 <- \n  fit3 %>%\n  select_by_one_std_err(metric = \"roc_auc\", -penalty)\n```\n:::\n\n\n\n\nFinalisieren:\n\n\n\n::: {.cell hash='klassifikation_cache/html/wf3-final_bd074d0e893b8ee46db45869b23c9096'}\n\n```{.r .cell-code}\nwf3_final <-\n  finalize_workflow(wf3, chosen_auc_fit3)\n\nwf3_final\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n‚ïê‚ïê Workflow ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\nPreprocessor: Recipe\nModel: logistic_reg()\n\n‚îÄ‚îÄ Preprocessor ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n6 Recipe Steps\n\n‚Ä¢ step_text_normalization()\n‚Ä¢ step_mutate()\n‚Ä¢ step_textfeature()\n‚Ä¢ step_tokenize()\n‚Ä¢ step_stopwords()\n‚Ä¢ step_word_embeddings()\n\n‚îÄ‚îÄ Model ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\nLogistic Regression Model Specification (classification)\n\nMain Arguments:\n  penalty = 0.00853167852417281\n  mixture = 1\n\nComputational engine: glmnet \n```\n:::\n:::\n\n::: {.cell hash='klassifikation_cache/html/fit3-final-train_cba676259966e4483a1c88270d7aaa1e'}\n\n```{.r .cell-code}\nfit3_final_train <-\n  fit(wf3_final, d_train)\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-47_6ed6cf365a77f1fdd682b1971bb95061'}\n\n:::\n\n::: {.cell hash='klassifikation_cache/html/fit3-final-train2_a77e4ab9d71f839a5e9ca4eac2f9dfb0'}\n\n```{.r .cell-code}\nfit3_final_train %>% \n  extract_fit_parsnip() %>% \n  tidy() %>% \n  arrange(-abs(estimate)) %>% \n  head()\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|term                             |   estimate|   penalty|\n|:--------------------------------|----------:|---------:|\n|(Intercept)                      |  1.2444586| 0.0085317|\n|profane_n                        | -0.6241517| 0.0085317|\n|wordembed_text_v055              |  0.1928172| 0.0085317|\n|textfeature_text_copy_n_exclaims | -0.1836999| 0.0085317|\n|wordembed_text_v054              |  0.1697083| 0.0085317|\n|wordembed_text_v070              | -0.1415024| 0.0085317|\n\n</div>\n:::\n:::\n\n::: {.cell hash='klassifikation_cache/html/fit3-final-test_b168698a8583335be4d966dc0c7fedfb'}\n\n```{.r .cell-code}\nfit3_final_test <-\n  last_fit(wf3_final, d_split)\n```\n:::\n\n::: {.cell hash='klassifikation_cache/html/load-fit3-final-test_006bedbbda023e68040e9d0911ad3e0e'}\n\n:::\n\n\n\nUnd endlich: Wie gut ist die Performanz?\n\n\n::: {.cell hash='klassifikation_cache/html/unnamed-chunk-48_82cc31bd25d259c86d0ed4b0aae6249d'}\n\n```{.r .cell-code}\ncollect_metrics(fit3_final_test)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|.metric  |.estimator | .estimate|.config              |\n|:--------|:----------|---------:|:--------------------|\n|accuracy |binary     | 0.7525938|Preprocessor1_Model1 |\n|roc_auc  |binary     | 0.8120519|Preprocessor1_Model1 |\n\n</div>\n:::\n:::\n\n\n\nAm Ende so eines Arbeitsganges,\nbei dem man wieder (und wieder) die gleichen Funktionen kopiert,\nund nur aufpassen muss, aus `fit2` an der richtigen Stelle `fit3` zu machen:\nDa blickt man jedem Umbau dieses Codes zu einer Funktion freudig ins Gesicht.\n\nEin anderes Problem,\nf√ºr das hier keine elegante L√∂sung vorliegt,\nsind die langen Berechnungszeiten, die, wenn man Pech hat, auch noch\nmehrfach wiederholt werden m√ºssen.\n\nDie Gefahr mit dem Abspeichern via `write_rds` ist klar:\nMan riskiert, sp√§ter ein veraltetes Objekt zu laden.\n\nZu diesen Punkten sp√§ter mehr.\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}